import{D as S}from"./DashboardLayout-A6a7l7S6.js";import{d as T,g as D}from"./GetFavoritesByUser-DUe6k6PA.js";import{T as g}from"./toastify-B53tPeiT.js";import{f as B,g as l,n as E,p as j,w as L,o as a,a as e,c as i,i as b,d as x,q as I,t as m,F as M,s as O,m as P}from"./index-Csc8XsQ4.js";import"./logo-v3-Caxdigjt.js";const U=async p=>await T(p.user_id,p.video_id),V={class:"container"},z={class:"d-flex justify-content-between align-items-center mb-3"},J={class:"d-flex align-items-center gap-2"},R=["disabled"],$={key:0,class:"spinner-border spinner-border-sm me-2"},q={key:1,class:"bi bi-arrow-clockwise me-1"},A={key:0,class:"text-white p-4"},Z={key:1,class:"text-danger"},G={key:2,class:"container-scroll-wrapper-all mt-3 p-3 rounded"},H={class:"row"},K={class:"card h-100 flex-row shadow-sm p-2 align-items-center video-card-custom"},Q=["src","alt"],W={class:"flex-grow-1 d-flex flex-column justify-content-between",style:{"min-width":"0"}},X=["title"],Y={class:"d-flex flex-wrap align-items-center justify-content-start gap-2 mt-2"},tt={class:"text-light date-container order-1"},et={class:"d-flex gap-2 order-2"},st=["onClick"],ot=["onClick","disabled"],at={key:0,class:"spinner-border spinner-border-sm"},it={key:1,class:"bi bi-trash-fill"},ut=B({__name:"FavoritesPage",setup(p){const v=l([]),n=l([]),r=l("recent"),c=l(!1),d=l(null),_=l({}),f=l(!1),y=()=>{const s=localStorage.getItem("userJearCastInfo");if(!s)return null;try{return JSON.parse(s).id||null}catch{return null}};function w(){r.value==="recent"?n.value=[...v.value].sort((s,t)=>(t.created_at?.toDate()?.getTime()||0)-(s.created_at?.toDate()?.getTime()||0)):r.value==="alphabetical"&&(n.value=[...v.value].sort((s,t)=>s.video_title.localeCompare(t.video_title)))}async function h(s=!1){if(f.value&&!s)return;const t=y();if(!t){d.value="Usuario no autenticado";return}c.value=!0,d.value=null;try{v.value=await D(t),w(),f.value=!0}catch(o){d.value="Error cargando favoritos",console.error(o)}finally{c.value=!1}}async function k(s){const t=y();if(t){_.value[s]=!0,g({text:"Eliminando...",duration:1500,className:"toast-glass",gravity:"top",position:"right"}).showToast();try{await U({user_id:t,video_id:s}),g({text:"Eliminado de favoritos",duration:1500,className:"toast-glass",gravity:"top",position:"right"}).showToast(),await h(!0)}catch(o){g({text:"Error al eliminar favorito",duration:1500,className:"toast-glass",gravity:"top",position:"right"}).showToast(),console.error(o)}finally{_.value[s]=!1}}}function C(s){const t=n.value.map(u=>({video_id:u.video_id,video_title:u.video_title,video_thumbnail:u.video_thumbnail}));P().setPlaylist(t,s)}function F(){r.value=r.value==="recent"?"alphabetical":"recent",w()}return E(()=>{h()}),(s,t)=>(a(),j(S,null,{default:L(()=>[e("div",V,[e("div",z,[t[2]||(t[2]=e("h4",{class:"text-white mb-0 title-page"},"Favoritos",-1)),e("div",J,[e("button",{onClick:F,class:"btn btn-light btn-sm"},[e("i",{class:I(r.value==="recent"?"bi bi-clock-history":"bi bi-sort-alpha-down")},null,2),x(" "+m(r.value==="recent"?"Recientes":"A-Z"),1)]),e("button",{onClick:t[0]||(t[0]=()=>h(!0)),disabled:c.value,class:"btn btn-outline-light btn-sm"},[c.value?(a(),i("span",$)):(a(),i("i",q)),t[1]||(t[1]=x(" Recargar "))],8,R)])]),v.value.length===0&&!c.value?(a(),i("div",A,"No tienes favoritos aÃºn.")):b("",!0),d.value?(a(),i("div",Z,m(d.value),1)):b("",!0),n.value.length>0?(a(),i("div",G,[e("div",H,[(a(!0),i(M,null,O(n.value,(o,u)=>(a(),i("div",{key:o.id,class:"col-12 col-md-6 col-lg-6 col-xl-3 mb-3"},[e("div",K,[e("img",{src:o.video_thumbnail,alt:o.video_title,class:"rounded-start me-3",style:{width:"120px",height:"80px","object-fit":"cover"}},null,8,Q),e("div",W,[e("h6",{class:"card-title text-truncate mb-1",title:o.video_title,style:{"font-size":"0.85rem"}},m(o.video_title),9,X),e("div",Y,[e("small",tt,m(o.created_at?.toDate().toLocaleDateString()),1),e("div",et,[e("button",{onClick:N=>C(u),class:"btn btn-sm"},t[3]||(t[3]=[e("i",{class:"bi bi-play-circle"},null,-1)]),8,st),e("button",{onClick:N=>k(o.video_id),class:"btn btn-sm text-light",disabled:_.value[o.video_id]},[_.value[o.video_id]?(a(),i("span",at)):(a(),i("i",it))],8,ot)])])])])]))),128))])])):b("",!0)])]),_:1}))}});export{ut as default};
