import{f as $,m as J,l as L,g as l,n as O,p as G,w as Y,o as r,a as t,c,i as S,d as o,t as y,q as j,F as I,s as N,k as B,x as K,v as Q,j as W,_ as X}from"./index-DXOHvAbe.js";import{g as z,D as Z,S as tt,s as et,a as F,c as st,b as at}from"./DashboardLayout-BSb27FIe.js";import{g as lt}from"./GetFavoritesByUser-DAXFcWzV.js";import{f as it}from"./RecommendedPlaylistFirestore-BZREpABI.js";import{T as _}from"./toastify-ChDLbD_3.js";import"./logo-v3-D2L8RnEv.js";async function ot(){return await it()}const nt={class:"container py-4"},rt={class:"row g-4"},dt={class:"col-md-6 col-xl-4"},ct={class:"card h-100 glass-card text-white p-3 shadow d-flex flex-column justify-content-between"},ut={class:"d-flex justify-content-between align-items-center mb-3"},mt={class:"badge bg-danger fs-6"},bt={class:"col-md-6 col-xl-4"},pt={class:"card h-100 glass-card text-white p-3 shadow d-flex flex-column justify-content-between"},vt={class:"d-flex justify-content-between align-items-center mb-3"},ft={class:"badge bg-primary fs-6"},gt={class:"col-md-6 col-xl-4"},yt={class:"card h-100 glass-card text-white p-3 shadow d-flex flex-column justify-content-between"},ht={class:"d-flex justify-content-between align-items-center mb-3"},xt={class:"badge bg-warning text-dark fs-6"},_t={class:"row g-4 mt-4"},wt={class:"col-md-9"},kt={class:"card glass-card text-white p-4 shadow",style:{"max-height":"450px"}},Pt={class:"d-flex justify-content-between align-items-center mb-3"},Ct={class:"d-flex gap-2"},Tt=["disabled"],St={key:0,class:"overflow-auto pe-2",style:{"max-height":"300px"}},jt={class:"d-flex flex-column gap-3"},It={class:"d-flex align-items-center gap-3"},Nt=["src"],Bt={class:"text-white text-truncate",style:{"max-width":"200px"}},zt={class:"d-flex gap-2"},Ft=["onClick"],Mt=["onClick"],At=["onClick"],Et={key:1,class:"text-center text-light mt-1",style:{"font-size":"13px"}},Vt={class:"search-modal-content"},Dt={class:"d-flex justify-content-between align-items-center mb-3"},Rt=["disabled"],Ut={key:0,class:"mb-3"},qt=["value"],Ht=$({__name:"HomePage",emits:["close","openPlaylistModal"],setup($t,{emit:Jt}){const M=J(),d=L(),k=l(0),P=l(0),C=l(0),u=l([]),b=l(!1),h=l([]),p=l(!1),v=l(""),x=l(""),f=l(!1),n=l(null),T=l({}),w=l(!1),A=s=>{if(!u.value.length)return;const e=u.value.map(a=>({video_id:a.video_id,video_title:a.video_title,video_thumbnail:a.video_thumbnail}));M.setPlaylist(e,s)},E=async()=>{if((await tt.fire({title:"¿Eliminar historial?",text:"Esta acción no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar",customClass:{popup:"glass-modal",title:"text-white",htmlContainer:"text-white",confirmButton:"btn btn-danger me-2",cancelButton:"btn btn-secondary"},buttonsStyling:!1})).isConfirmed)try{localStorage.removeItem("recentlyPlayed"),u.value=[],_({text:"Historial eliminado",gravity:"top",position:"right",backgroundColor:"#dc3545"}).showToast()}catch{_({text:"Error al eliminar el historial",gravity:"top",position:"right",backgroundColor:"#ffc107"}).showToast()}},i=s=>{_({text:s,duration:2e3,gravity:"top",position:"right",className:"toast-glass"}).showToast()},V=()=>{p.value=!0,setTimeout(()=>{const s=localStorage.getItem("recentlyPlayed");u.value=s?JSON.parse(s):[],i("Historial actualizado"),p.value=!1},1e3)},D=async()=>{d.id&&(w.value=!0,h.value=await z(d.id),i("Playlists actualizadas"),setTimeout(()=>{w.value=!1},1e3))},R=async s=>{if(!d.id||T.value[s.videoId])return;T.value[s.videoId]=!0;const e=s.video_id||s.videoId,a=s.video_title||s.title,g=s.video_thumbnail||s.thumbnail,m=await at({user_id:d.id,video_id:e,video_title:a,video_thumbnail:g});_({text:m==="exists"?"Ya está en favoritos":"Agregado a favoritos",duration:2e3,gravity:"top",position:"right",className:"toast-glass"}).showToast()},U=s=>{n.value=s,f.value=!0};O(async()=>{const s=d.id;if(!s)return;const[e,a,g]=await Promise.all([lt(s),z(s),ot()]);k.value=e.length,P.value=a.length,C.value=g.length,h.value=a;const m=localStorage.getItem("recentlyPlayed");m&&(u.value=JSON.parse(m))});const q=async()=>{if(!b.value){if(!d.id||!n.value||!v.value)return i("Faltan datos para agregar a la playlist");b.value=!0,i("Añadiendo a la playlist...");try{if(await et(v.value,n.value.video_id))return i("La canción ya está en esta playlist");await F(v.value,{video_id:n.value.video_id,video_title:n.value.video_title,video_thumbnail:n.value.video_thumbnail}),i("Agregado a la playlist"),f.value=!1}catch{i("Error al agregar a la playlist")}finally{b.value=!1}}},H=async()=>{if(!b.value){if(!x.value||!d.id)return i("Nombre no válido");b.value=!0,i("Creando playlist...");try{const s={name:x.value.trim(),user_id:d.id},e=await st(s);await F(e,{video_id:n.value.videoId,video_title:n.value.title,video_thumbnail:n.value.thumbnail}),i("Canción añadida a la nueva playlist"),f.value=!1}catch{i("Error al agregar a la playlist")}finally{b.value=!1}}};return(s,e)=>(r(),G(Z,null,{default:Y(()=>[t("section",nt,[t("div",rt,[t("div",dt,[t("div",ct,[t("div",ut,[e[3]||(e[3]=t("h5",{class:"mb-0"},[t("i",{class:"bi bi-heart-fill text-danger me-2"}),o("Tus Favoritos")],-1)),t("span",mt,y(k.value),1)]),e[4]||(e[4]=t("img",{src:"https://cdn-icons-png.flaticon.com/512/833/833472.png",alt:"Favoritos",class:"img-fluid mx-auto float-animation",style:{"max-height":"80px",filter:"drop-shadow(0 0 6px white)","margin-bottom":"20px","margin-top":"20px"}},null,-1))])]),t("div",bt,[t("div",pt,[t("div",vt,[e[5]||(e[5]=t("h5",{class:"mb-0"},[t("i",{class:"bi bi-music-note-list me-2"}),o("Tus Playlists")],-1)),t("span",ft,y(P.value),1)]),e[6]||(e[6]=t("img",{src:"https://cdn-icons-png.flaticon.com/512/984/984451.png",alt:"Playlist",class:"img-fluid mx-auto float-animation",style:{"max-height":"95px",filter:"drop-shadow(0 0 6px white)","margin-bottom":"20px","margin-top":"20px"}},null,-1))])]),t("div",gt,[t("div",yt,[t("div",ht,[e[7]||(e[7]=t("h5",{class:"mb-0"},[t("i",{class:"bi bi-stars me-2 text-warning"}),o("Playlist JearCastApp")],-1)),t("span",xt,y(C.value),1)]),e[8]||(e[8]=t("img",{src:"https://cdn-icons-png.flaticon.com/512/2909/2909734.png",alt:"Recomendados",class:"img-fluid mx-auto float-animation",style:{"max-height":"80px",filter:"drop-shadow(0 0 6px white)","margin-bottom":"20px","margin-top":"20px"}},null,-1))])])]),t("div",_t,[t("div",wt,[t("div",kt,[t("div",Pt,[e[10]||(e[10]=t("h5",{class:"mb-0 text-white"},[t("i",{class:"bi bi-clock-history me-2"}),o(" Tus reproducciones ")],-1)),t("div",Ct,[t("button",{onClick:V,disabled:p.value,class:"btn btn-sm btn-outline-light me-2 d-flex align-items-center justify-content-center",style:{"border-radius":".50rem"}},[t("i",{class:j(["bi","me-0",p.value?"bi-arrow-repeat spin-animation":"bi-arrow-clockwise"])},null,2)],8,Tt),t("button",{onClick:E,class:"btn btn-sm btn-outline-light",style:{"border-radius":".50rem"}},e[9]||(e[9]=[t("i",{class:"bi bi-trash3-fill"},null,-1)]))])]),e[15]||(e[15]=t("p",{class:"text-truncate mb-3",style:{"font-size":"13px"}},[o(" Aquí aparecerán las últimas músicas reproducidas desde el buscador. "),t("br"),t("span",{style:{"font-size":"10px"}},[t("i",{class:"bi bi-exclamation-triangle me-2"}),o(" Cuando cierres sesión los datos de tu navegación se perderán. ")])],-1)),u.value.length?(r(),c("div",St,[t("div",jt,[(r(!0),c(I,null,N(u.value,(a,g)=>(r(),c("div",{key:a.video_id,class:"d-flex align-items-center justify-content-between rounded p-2",style:{"background-color":"var(--primary-bg) !important","backdrop-filter":"blur(6px)","-webkit-backdrop-filter":"blur(6px)",border:"0.5px solid rgba(255, 255, 255, 0.1)"}},[t("div",It,[t("img",{src:a.video_thumbnail,alt:"thumbnail",width:"60",height:"40",class:"rounded",style:{"object-fit":"cover","box-shadow":"0 0 5px rgba(255,255,255,0.3)"}},null,8,Nt),t("span",Bt,y(a.video_title),1)]),t("div",zt,[t("button",{onClick:m=>A(g),class:"btn btn-sm",style:{border:"0.5px solid #f4f4f4","border-radius":"1rem"}},e[11]||(e[11]=[t("i",{class:"bi bi-play-circle",style:{color:"#f4f4f4"}},null,-1)]),8,Ft),t("button",{onClick:m=>R(a),class:"btn btn-sm",style:{border:"0.5px solid #f4f4f4","border-radius":"1rem"}},e[12]||(e[12]=[t("i",{class:"bi bi-heart",style:{color:"#f4f4f4"}},null,-1)]),8,Mt),t("button",{onClick:m=>U(a),class:"btn btn-sm",style:{border:"0.5px solid #f4f4f4","border-radius":"1rem"}},e[13]||(e[13]=[t("i",{class:"bi bi-plus-lg",style:{color:"#f4f4f4"}},null,-1)]),8,At)])]))),128))])])):(r(),c("div",Et,e[14]||(e[14]=[t("i",{class:"bi bi-music-note-beamed"},null,-1),o(" No hay reproducciones recientes aún. ")])))])]),e[16]||(e[16]=t("div",{class:"col-md-3 d-none d-md-block"},[t("div",{class:"glass-card d-flex align-items-center justify-content-center text-white text-center p-3 shadow",style:{height:"450px"}},[t("div",null,[t("i",{class:"bi bi-box-arrow-in-down-right fs-1 mb-2"}),t("p",{class:"mb-0",style:{"font-size":"14px"}},[o(" Si te hace feliz"),t("br"),o(" mueve el reproductor aqui "),t("br"),t("span",{style:{"font-size":"13px"}},[o("(solo es para que tengas donde ubicarlo, "),t("br"),o(" no hay magia, funcionalidad o anclamiento de por medio)")])])])])],-1))]),f.value?(r(),c("div",{key:0,class:"modal-backdrop",onClick:e[2]||(e[2]=W(a=>f.value=!1,["self"]))},[t("div",Vt,[t("div",Dt,[e[17]||(e[17]=t("h5",{class:"text-white mb-0"},"Agregar / Crear Playlist",-1)),t("button",{class:"btn btn-outline-light d-flex align-items-center justify-content-center",onClick:D,disabled:p.value,style:{"border-radius":"1rem",height:"36px",padding:"0 10px"}},[t("i",{class:j(["bi","me-0",w.value?"bi-arrow-repeat spin-animation":"bi-arrow-clockwise"]),style:{"font-size":"16px","vertical-align":"middle","line-height":"1"}},null,2)],8,Rt)]),h.value.length>0?(r(),c("div",Ut,[B(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>v.value=a),class:"form-select mb-2"},[e[18]||(e[18]=t("option",{disabled:"",value:""},"Selecciona una playlist",-1)),(r(!0),c(I,null,N(h.value,a=>(r(),c("option",{key:a.id,value:a.id},y(a.name),9,qt))),128))],512),[[K,v.value]]),t("button",{class:"btn btn-outline-light btn-search w-100 mb-3",onClick:q},"Agregar a la playlist")])):S("",!0),t("div",null,[B(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>x.value=a),type:"text",class:"form-control mb-2",placeholder:"Nueva playlist..."},null,512),[[Q,x.value]]),t("button",{class:"btn btn-outline-light btn-search w-100",onClick:H},"Crear y agregar")])])])):S("",!0)])]),_:1}))}}),Wt=X(Ht,[["__scopeId","data-v-7eb0c0c6"]]);export{Wt as default};
