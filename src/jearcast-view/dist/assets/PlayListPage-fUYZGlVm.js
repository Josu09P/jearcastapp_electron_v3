import{f as T,D as B,g as E,S as I}from"./DashboardLayout-A6a7l7S6.js";import{T as r}from"./toastify-B53tPeiT.js";import{d as L,a as N}from"./RecommendedPlaylistFirestore-CXob9_ed.js";import{f as j,g as u,n as F,p as D,w as $,o as i,a as s,c as l,d as A,s as g,t as f,F as b,m as J,_ as M}from"./index-Csc8XsQ4.js";import"./logo-v3-Caxdigjt.js";async function O(c){return await T(c)}async function U(c,d){await L(c,d)}async function V(c){await N(c)}const Y={class:"container"},z={class:"d-flex justify-content-between align-items-center mb-3"},K=["disabled"],R={key:0,class:"spinner-border spinner-border-sm me-2"},q={key:1,class:"bi bi-arrow-clockwise me-1"},G={class:"d-flex flex-wrap gap-2 mb-3"},H=["onClick"],Q=["onClick"],W={key:0,class:"container-scroll-wrapper-all mt-3 p-3 rounded"},X={class:"row"},Z={class:"card h-100 flex-row shadow-sm p-2 align-items-center video-card-custom"},tt=["src","alt"],et={class:"flex-grow-1 d-flex flex-column justify-content-between",style:{"min-width":"0"}},st=["title"],at={class:"d-flex justify-content-start gap-2 mt-2"},it=["onClick"],lt=["onClick","disabled"],ot={key:0,class:"spinner-border spinner-border-sm"},nt={key:1,class:"bi bi-trash-fill"},rt={key:1,class:"text-white p-4"},p="jearcast_selectedPlaylistId",ct=j({__name:"PlayListPage",setup(c){const d=u([]),o=u([]),v=u(null),m=u({}),y=u(!1),w=()=>{const t=localStorage.getItem("userJearCastInfo");if(!t)return null;try{return JSON.parse(t).id||null}catch{return null}};function x(t){v.value=t,localStorage.setItem(p,t)}async function _(){const t=w();if(t){y.value=!0;try{d.value=await E(t)}catch{r({text:"Error cargando playlists",className:"toast-glass",gravity:"top",position:"right"}).showToast()}finally{y.value=!1}}}async function h(t){x(t);try{o.value=await O(t)}catch{r({text:"Error cargando canciones",className:"toast-glass",gravity:"top",position:"right"}).showToast()}}function S(t){const e=o.value.map(n=>({video_id:n.video_id,video_title:n.video_title,video_thumbnail:n.video_thumbnail}));J().setPlaylist(e,t)}async function k(t){if(v.value){m.value[t]=!0,r({text:"Eliminando canción...",className:"toast-glass",gravity:"top",position:"right"}).showToast();try{await U(v.value,t),o.value=o.value.filter(e=>e.video_id!==t),r({text:"Canción eliminada",className:"toast-glass",gravity:"top",position:"right"}).showToast()}catch{r({text:"Error al eliminar canción",className:"toast-glass",gravity:"top",position:"right"}).showToast()}finally{m.value[t]=!1}}}async function P(t){if((await I.fire({title:"¿Eliminar playlist?",text:"Esta acción no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar",customClass:{popup:"glass-modal",title:"text-white",htmlContainer:"text-white",confirmButton:"btn btn-danger me-2",cancelButton:"btn btn-secondary"},buttonsStyling:!1})).isConfirmed)try{await V(t),d.value=d.value.filter(a=>a.id!==t),o.value=[],localStorage.removeItem(p),r({text:"Playlist eliminada",gravity:"top",position:"right",backgroundColor:"#dc3545"}).showToast()}catch{r({text:"Error al eliminar playlist",gravity:"top",position:"right"}).showToast()}}return F(async()=>{await _();const t=localStorage.getItem(p);t&&h(t)}),(t,e)=>(i(),D(B,null,{default:$(()=>[s("div",Y,[s("div",z,[e[1]||(e[1]=s("h4",{class:"text-white mb-0 title-page"},"Playlists",-1)),s("button",{onClick:_,class:"btn btn-outline-light btn-sm",disabled:y.value},[y.value?(i(),l("span",R)):(i(),l("i",q)),e[0]||(e[0]=A(" Recargar "))],8,K)]),s("div",G,[(i(!0),l(b,null,g(d.value,a=>(i(),l("div",{key:a.id,class:"btn-group"},[s("button",{class:"btn btn-outline-light btn-sm",onClick:n=>h(a.id)},f(a.name),9,H),s("button",{class:"btn btn-outline-light btn-sm",onClick:n=>P(a.id)},e[2]||(e[2]=[s("i",{class:"bi bi-trash"},null,-1)]),8,Q)]))),128))]),e[4]||(e[4]=s("div",{class:"text-white rounded shadow mt-4 container-player-jear",id:"player-playlist-container"},null,-1)),o.value.length>0?(i(),l("div",W,[s("div",X,[(i(!0),l(b,null,g(o.value,(a,n)=>(i(),l("div",{key:a.video_id,class:"col-12 col-md-6 col-lg-6 col-xl-3 mb-3"},[s("div",Z,[s("img",{src:a.video_thumbnail,alt:a.video_title,class:"rounded-start me-3",style:{width:"120px",height:"80px","object-fit":"cover"}},null,8,tt),s("div",et,[s("h6",{class:"card-title text-truncate mb-1",title:a.video_title,style:{"font-size":"0.85rem"}},f(a.video_title),9,st),s("div",at,[s("button",{onClick:C=>S(n),class:"btn btn-sm"},e[3]||(e[3]=[s("i",{class:"bi bi-play-circle"},null,-1)]),8,it),s("button",{onClick:C=>k(a.video_id),class:"btn btn-sm text-light",disabled:m.value[a.video_id]},[m.value[a.video_id]?(i(),l("span",ot)):(i(),l("i",nt))],8,lt)])])])]))),128))])])):(i(),l("div",rt,"Selecciona una playlist para ver sus canciones."))])]),_:1}))}}),pt=M(ct,[["__scopeId","data-v-223de2df"]]);export{pt as default};
